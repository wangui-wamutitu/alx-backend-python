#!/bin/bash
# kubctl-0x01 - Scales the Django app and performs load testing

# Scale the deployment to 3 replicas
echo "Scaling deployment to 3 replicas..."
kubectl scale deployment django-messaging-app --replicas=3

# Verify pods are running
echo "Current running pods:"
kubectl get pods -l app=django-messaging

# Perform load testing (requires wrk installed)
echo "Starting load testing..."
SERVICE_IP=$(minikube service django-service --url)
wrk -t4 -c100 -d30s $SERVICE_IP

# Monitor resource usage
echo "Resource usage:"
kubectl top pods -l app=django-messaging